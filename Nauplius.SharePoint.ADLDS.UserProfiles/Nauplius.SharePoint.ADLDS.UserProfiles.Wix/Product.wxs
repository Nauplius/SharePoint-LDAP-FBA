<?xml version="1.0" encoding="UTF-8"?>
<Wix xmlns="http://schemas.microsoft.com/wix/2006/wi">
	<Product Id="ac3e4ef9-395f-4805-bb17-d934d1d64351" 
					 Name="Nauplius.SharePoint.ADLDS.UserProfiles" 
					 Language="1033" 
					 Version="1.0.0.0" 
					 Manufacturer="Nauplius" 
					 UpgradeCode="76d13273-a523-44e3-a28a-d14a811a55d0">
		<Package InstallerVersion="200" Compressed="yes" Manufacturer="Nauplius" />

		<Media Id="1" Cabinet="Nauplius.SharePoint.ADLDS.UserProfiles.cab" EmbedCab="yes" />

		<Property Id="SERVICE_USERNAME" Hidden="yes"/>
		<Property Id="SERVICE_PASSWORD" Hidden="yes" />

		<Directory Id="TARGETDIR" Name="SourceDir">
			<Directory Id="ProgramFilesFolder">
				<Directory Id="MANUFACTUREDIR" Name="Nauplius">
					<Directory Id="INSTALLLOCATION" Name="Nauplius.SharePoint.ADLDS.UserProfiles">
						<Component Id="ProductComponent" Guid="40800423-de35-4dbf-ae39-1e11865e534f">
							<File Id="Nauplius.SharePoint.ADLDS.UserProfiles.exe" Name="Nauplius.SharePoint.ADLDS.UserProfiles.exe"
										Source="..\Nauplius.SharePoint.ADLDS.UserProfiles\bin\x64\Release\Nauplius.SharePoint.ADLDS.UserProfiles.exe" Vital="yes" DiskId="1"></File>
							<File Id="Nauplius.SharePoint.ADLDS.UserProfiles.exe.config" Name="Nauplius.SharePoint.ADLDS.UserProfiles.exe.config"
										Source="..\Nauplius.SharePoint.ADLDS.UserProfiles\bin\x64\Release\Nauplius.SharePoint.ADLDS.UserProfiles.exe.config" Vital="yes" DiskId="1"></File>
							<File Id="Nauplius.SharePoint.ADLDS.Configuration.dll" Name="Nauplius.SharePoint.ADLDS.Configuration.dll"
										Source="..\Nauplius.SharePoint.ADLDS.UserProfiles\bin\x64\Release\Nauplius.SharePoint.ADLDS.Configuration.dll" Vital="yes" DiskId="1"></File>
							<ServiceInstall Id="ServiceInstaller"
															Type="ownProcess"
															Vital="yes"
															Name="Nauplius.SharePoint.ADLDS.UserProfiles"
															DisplayName="Nauplius.SharePoint.ADLDS.UserProfiles"
															Description="Imports AD LDS/ADAM Users into the SharePoint User Profile Application"
															Start="auto"
															ErrorControl="normal"
															Interactive="no"
															Account="[SERVICE_USERNAME]"
															Password="[SERVICE_PASSWORD]">
							</ServiceInstall>
							<ServiceControl Id="StartService" Stop="both" Remove="uninstall" Name="Nauplius.SharePoint.ADLDS.UserProfiles"></ServiceControl>
						</Component>
					</Directory>
				</Directory>
			</Directory>
		</Directory>
		<Feature Id="ProductFeature" Title="Nauplius.SharePoint.ADLDS.UserProfiles.Wix" Level="1">
			<ComponentRef Id="ProductComponent" />
		</Feature>
		<Property Id="SERVICE_LOGON_BROWSE" Value="1" />
		<Property Id="SERVICE_REQUIRE_ADMIN" Value="1" />
		<Property Id="IMPERSONATE_PASSWORD" Hidden="yes" />
		
		<UI>

			<!-- CommonU UI Dialogs-->
			<DialogRef Id="ServiceCredDlg" />
			<DialogRef Id="GenericErrorDlg" />

			<!-- UIExtension Dialogs-->
			<DialogRef Id="WelcomeDlg"/>
			<DialogRef Id="VerifyReadyDlg"/>

			<DialogRef Id="ErrorDlg" />
			<DialogRef Id="FatalError" />
			<DialogRef Id="FilesInUse" />
			<DialogRef Id="UserExit" />


			<Publish Dialog="WelcomeDlg" Control="Next" Event="NewDialog" Value="ServiceCredDlg">NOT Installed</Publish>

			<Publish Dialog="ServiceCredDlg" Control="Next" Event="NewDialog" Value="VerifyReadyDlg">NOT Installed</Publish>
			<Publish Dialog="ServiceCredDlg" Control="Back" Event="NewDialog" Value="WelcomeDlg">NOT Installed</Publish>
			<Publish Dialog="VerifyReadyDlg" Control="Back" Event="NewDialog" Value="ServiceCredDlg">NOT Installed</Publish>

			<Publish Dialog="ExitDialog" Control="Back" Event="EndDialog" Value="ServiceCredDlg">1</Publish>
			<Publish Dialog="ExitDialog" Control="Finish" Event="EndDialog" Value="Return" Order="999">1</Publish>
		</UI>
	</Product>
</Wix>
